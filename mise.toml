[tools]
  bun = "1.3.7"
  pkl = "0.30.2"
  ruby = "4.0.1"
  hk = "1.35.0"
  overmind = "latest"

  # [env]
  #   PATH = "${config_root}/node_modules/.bin:${PATH}"

[tasks]
  # Development flow
  setup = { run = "bin/setup" }
  dev = { run = "bin/dev" }
  attach = { run = "bin/attach" }
  restart = { run = "bin/overmind restart" }
  test = { run = "bin/rails test" }

  # Tools
  fix = { run = "hk fix" }
  check = { run = "hk check" }
  annotate = { run = "bin/annotaterb models" }

  # Connect to production server
  ssh = { run = "fly ssh console" }
  console = { run = "fly ssh console --pty -C 'bin/rails console'" }

[hooks]
  postinstall = 'if [ -z "$CI" ]; then bin/setup --skip-server; fi'

[settings]
  experimental = true
